# SPEC-OBSIDIAN-TTS-BELL-CACHE-001: 수용 기준

## 태그 블록

```yaml
tags: [ACCEPTANCE, TTS, bell, cache, obsidian, audio]
spec: SPEC-OBSIDIAN-TTS-BELL-CACHE-001
domain: OBSIDIAN
status: COMPLETED
created: 2026-02-05
completed: 2026-02-05
```

## 수용 기준 개요 (Acceptance Criteria Overview)

본 SPEC의 성공적인 완료를 위한 Given-When-Then 형식의 수용 기준입니다.

## UC-01: 캐시된 토픽 재생 시 종소리 재생

### 시나리오 1.1: 오프라인 캐시된 오디오 재생

**Given** 사용자가 종소리 설정을 활성화해두고
**And** 특정 토픽의 오디오가 오프라인 캐시에 저장되어 있고
**When** 사용자가 해당 토픽을 재생하면
**Then** 시스템은 종소리 효과음을 먼저 재생해야 하고
**And** 종소리 종료 후 캐시된 TTS 오디오를 재생해야 한다

### 시나리오 1.2: 서버 캐시된 오디오 재생

**Given** 사용자가 종소리 설정을 활성화해두고
**And** 특정 토픽의 오디오가 서버 캐시에 저장되어 있고
**When** 사용자가 해당 토픽을 재생하면
**Then** 시스템은 종소리 효과음을 먼저 재생해야 하고
**And** 종소리 종료 후 서버 캐시된 TTS 오디오를 재생해야 한다

### 시나리오 1.3: 종소리 비활성화 상태

**Given** 사용자가 종소리 설정을 비활성화해두고
**And** 특정 토픽의 오디오가 캐시에 저장되어 있고
**When** 사용자가 해당 토픽을 재생하면
**Then** 시스템은 종소리 없이 바로 TTS 오디오를 재생해야 한다

### 시나리오 1.4: 종소리 재생 실패 시 폴백

**Given** 사용자가 종소리 설정을 활성화해두고
**And** 특정 토픽의 오디오가 캐시에 저장되어 있고
**When** 사용자가 해당 토픽을 재생 중 종소리 재생이 실패하면
**Then** 시스템은 에러를 로깅하고
**And** TTS 오디오를 정상 재생해야 한다

## UC-02: 개별 캐시 삭제

### 시나리오 2.1: 단일 캐시 삭제

**Given** 사용자가 캐시된 토픽 목록을 보고 있고
**And** 특정 토픽의 캐시가 존재하고
**When** 사용자가 해당 토픽의 삭제 버튼을 클릭하면
**Then** 시스템은 삭제 확인 다이얼로그를 표시해야 하고
**And** 사용자가 확인을 클릭하면 오프라인/서버 캐시를 모두 삭제해야 한다

### 시나리오 2.2: 삭제 취소

**Given** 사용자가 캐시된 토픽 목록을 보고 있고
**When** 사용자가 삭제 버튼을 클릭 후 취소를 선택하면
**Then** 시스템은 캐시를 유지해야 한다

### 시나리오 2.3: 삭제 실패 처리

**Given** 사용자가 캐시 삭제를 요청했고
**When** 네트워크 오류로 인해 서버 캐시 삭제가 실패하면
**Then** 시스템은 오프라인 캐시만 삭제하고
**And** "서버 캐시 삭제 실패" 메시지를 표시해야 한다

## UC-03: 개별 캐시 재생성

### 시나리오 3.1: 기본 재생성

**Given** 사용자가 캐시된 토픽 목록을 보고 있고
**And** 특정 토픽의 캐시가 존재하고
**When** 사용자가 해당 토픽의 재생성 버튼을 클릭하면
**Then** 시스템은 기존 캐시를 삭제하고
**And** TTS를 새로 생성해야 하고
**And** 종소리가 활성화된 경우 종소리를 병합해야 하고
**And** 새로운 캐시를 저장해야 한다

### 시나리오 3.2: 재생성 중 로딩 표시

**Given** 사용자가 캐시 재생성을 요청했고
**When** 재생성이 진행 중이면
**Then** 시스템은 해당 토픽 행에 로딩 스피너를 표시해야 하고
**And** 재생성 버튼을 비활성화해야 한다

### 시나리오 3.3: 재생성 완료 후 자동 재생

**Given** 사용자가 캐시 재생성을 요청했고
**And** "재생성 후 자동 재생" 설정이 활성화되어 있고
**When** 재생성이 완료되면
**Then** 시스템은 새로 생성된 오디오를 자동 재생해야 한다

## UC-04: 캐시 상태 시각화

### 시나리오 4.1: 캐시 상태 아이콘

**Given** 사용자가 토픽 목록을 보고 있고
**When** 각 토픽의 캐시 상태가 다르면
**Then** 시스템은 다음 아이콘을 표시해야 한다:
- 💾 회색: 캐시 없음
- 💾 파랑: 오프라인 캐시만
- 💾 초록: 서버+오프라인 캐시

### 시나리오 4.2: 캐시 크기 표시

**Given** 사용자가 토픽 행 위에 마우스를 올리면
**When** 해당 토픽의 캐시가 존재하면
**Then** 시스템은 툴팁으로 캐시 크기를 표시해야 한다

## UC-05: 대량 작업

### 시나리오 5.1: 전체 선택 후 삭제

**Given** 사용자가 캐시된 토픽 목록을 보고 있고
**When** 사용자가 "전체 선택" 체크박스를 클릭하고
**And** "선택 삭제" 버튼을 클릭하면
**Then** 시스템은 선택된 모든 토픽의 캐시를 삭제해야 한다

### 시나리오 5.2: 일괄 재생성

**Given** 사용자가 다중 토픽을 선택했고
**When** 사용자가 "선택 재생성" 버튼을 클릭하면
**Then** 시스템은 선택된 토픽을 순차적으로 재생성해야 하고
**And** 각 재생성 진행 상황을 표시해야 한다

## UC-06: 오프라인 모드

### 시나리오 6.1: 오프라인 모드에서 캐시 삭제

**Given** 사용자가 오프라인 모드이고
**And** 특정 토픽의 캐시가 존재하고
**When** 사용자가 삭제 버튼을 클릭하면
**Then** 시스템은 오프라인 캐시만 삭제하고
**And** 서버 캐시 삭제는 시도하지 않아야 한다

### 시나리오 6.2: 오프라인 모드에서 재생성

**Given** 사용자가 오프라인 모드이고
**When** 사용자가 재생성 버튼을 클릭하면
**Then** 시스템은 "오프라인 모드에서는 재생성할 수 없습니다" 메시지를 표시해야 한다

## 품질 기준 (Quality Gates)

### Q1: 성능
- 캐시 삭제: 1초 이내 완료
- 캐시 재생성: 5초 이내 완료 (네트워크 환경 고려)
- 종소리 재생 지연: 100ms 이내

### Q2: 사용자 경험
- 모든 버튼 클릭에 즉각적인 피드백
- 로딩 상태 명확하게 표시
- 에러 메시지가 명확하고 조치 가능해야 함

### Q3: 호환성
- Chrome, Edge, Safari, Firefox 최신 버전 지원
- 모바일 브라우저 지원
- iOS 백그라운드 재생 호환

## 테스트 데이터 (Test Data)

### 샘플 토픽 데이터
```
토픽 1: "데이터베이스 트랜잭션"
- 캐시 상태: 서버+오프라인
- 종소리: 비활성화된 캐시

토픽 2: "REST API 설계"
- 캐시 상태: 오프라인만
- 종소리: 비활성화된 캐시

토픽 3: "마이크로서비스 아키텍처"
- 캐시 상태: 없음
```

### 테스트 시나리오 순서
1. 캐시된 토픽 재생 (종소리 확인)
2. 개별 캐시 삭제
3. 캐시 재생성
4. 오프라인 모드 테스트
5. 대량 작업 테스트
