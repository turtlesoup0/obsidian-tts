# XSS Prevention Rules

id: xss-dangerouslySetInnerHTML
language: tsx
severity: warning
message: "XSS risk: Sanitize content before using dangerouslySetInnerHTML"
rule:
  pattern: 'dangerouslySetInnerHTML={{ __html: $CONTENT }}'

---
id: xss-dangerouslySetInnerHTML-jsx
language: javascript
severity: warning
message: "XSS risk: Sanitize content before using dangerouslySetInnerHTML"
rule:
  pattern: 'dangerouslySetInnerHTML={{ __html: $CONTENT }}'

---
id: xss-innerHTML
language: javascript
severity: warning
message: "Potential XSS: innerHTML assignment with user input"
rule:
  any:
    - pattern: '$EL.innerHTML = $CONTENT'
    - pattern: 'document.write($CONTENT)'
    - pattern: '$EL.outerHTML = $CONTENT'

---
id: xss-document-write
language: javascript
severity: error
message: "document.write is a security risk and bad practice"
rule:
  pattern: 'document.write($CONTENT)'

---
id: xss-eval-usage
language: javascript
severity: error
message: "eval() is dangerous and can lead to code injection"
rule:
  any:
    - pattern: 'eval($CODE)'
    - pattern: 'new Function($CODE)'

---
id: xss-setTimeout-string-eval
language: javascript
severity: error
message: "setTimeout with string argument acts like eval() - use a function instead"
rule:
  pattern: 'setTimeout($CODE, $DELAY)'
constraints:
  CODE:
    kind: string

---
id: xss-setInterval-string-eval
language: javascript
severity: error
message: "setInterval with string argument acts like eval() - use a function instead"
rule:
  pattern: 'setInterval($CODE, $DELAY)'
constraints:
  CODE:
    kind: string
